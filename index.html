<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ECU EMU Wiring Diagram - ESP32</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  margin: 20px;
}
h1, h2 {
  color: #38bdf8;
}
table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 25px;
}
th, td {
  border: 1px solid #334155;
  padding: 8px;
  text-align: left;
}
th {
  background: #1e293b;
  color: #7dd3fc;
}
.section {
  border: 1px solid #334155;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 30px;
  background: #020617;
}
.pin {
  color: #22c55e;
}
.note {
  color: #facc15;
}
.badge {
  background: #2563eb;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
}
</style>
</head>

<body>

<h1>üîß ECU EMU Wiring Diagram</h1>
<p>ESP32 + MCP2515 + 2x PCF8574 + 2x ADS1115 + L298N</p>

<!-- ESP32 -->
<div class="section">
<h2>1Ô∏è‚É£ ESP32 Core Pins</h2>
<table>
<tr><th>Fungsi</th><th>GPIO ESP32</th><th>Keterangan</th></tr>
<tr><td>CAN CS</td><td class="pin">GPIO5</td><td>MCP2515 CS</td></tr>
<tr><td>CAN INT</td><td class="pin">GPIO4</td><td>MCP2515 Interrupt</td></tr>
<tr><td>I2C SDA</td><td class="pin">GPIO21</td><td>ADS1115 + PCF8574</td></tr>
<tr><td>I2C SCL</td><td class="pin">GPIO22</td><td>ADS1115 + PCF8574</td></tr>
<tr><td>CKP IN (N1+)</td><td class="pin">GPIO27</td><td>Input pulsa CKP (REAL)</td></tr>
<tr><td>CKP GEN OUT</td><td class="pin">GPIO16</td><td>Output 33-3 (loop ke N1+)</td></tr>
<tr><td>CMP IN</td><td class="pin">GPIO34</td><td>Input pulsa CMP</td></tr>
<tr><td>VVTI Sense</td><td class="pin">GPIO25</td><td>ON = VVTI terpasang</td></tr>
<tr><td>VVTI PWM</td><td class="pin">GPIO33</td><td>PWM solenoid VVTI</td></tr>
<tr><td>REV OUT</td><td class="pin">GPIO14</td><td>RPM output ke tachometer</td></tr>
<tr><td>L298 ENA</td><td class="pin">GPIO32</td><td>PWM motor driver</td></tr>
</table>
</div>

<!-- MCP2515 -->
<div class="section">
<h2>2Ô∏è‚É£ MCP2515 CAN BUS</h2>
<table>
<tr><th>MCP2515</th><th>ESP32</th><th>Catatan</th></tr>
<tr><td>CS</td><td class="pin">GPIO5</td><td>SPI CS</td></tr>
<tr><td>INT</td><td class="pin">GPIO4</td><td>Interrupt CAN</td></tr>
<tr><td>MOSI</td><td class="pin">GPIO23</td><td>SPI default</td></tr>
<tr><td>MISO</td><td class="pin">GPIO19</td><td>SPI default</td></tr>
<tr><td>SCK</td><td class="pin">GPIO18</td><td>SPI default</td></tr>
<tr><td>CANH</td><td>-</td><td>Ke OBD / Scanner</td></tr>
<tr><td>CANL</td><td>-</td><td>Ke OBD / Scanner</td></tr>
</table>
</div>

<!-- ADS1115 -->
<div class="section">
<h2>3Ô∏è‚É£ ADS1115 (ADC)</h2>

<h3>ADS1115 #1 (0x48)</h3>
<table>
<tr><th>Channel</th><th>Sensor</th></tr>
<tr><td>A0</td><td>MAP</td></tr>
<tr><td>A1</td><td>TPS</td></tr>
<tr><td>A2</td><td>ECT / WTS</td></tr>
<tr><td>A3</td><td>IAT</td></tr>
</table>

<h3>ADS1115 #2 (0x49)</h3>
<table>
<tr><th>Channel</th><th>Sensor</th></tr>
<tr><td>A0</td><td>O2 Sensor</td></tr>
<tr><td>A1</td><td>Knock Sensor</td></tr>
<tr><td>A2</td><td>RPM Potensiometer</td></tr>
<tr><td>A3</td><td>Spare</td></tr>
</table>
</div>

<!-- PCF8574 -->
<div class="section">
<h2>4Ô∏è‚É£ PCF8574 Output Expanders</h2>

<h3>PCF8574 #1 (0x20) <span class="badge">AKTIF LOW</span></h3>
<table>
<tr><th>Pin</th><th>Output</th></tr>
<tr><td>P0</td><td>INJ 1</td></tr>
<tr><td>P1</td><td>INJ 2</td></tr>
<tr><td>P2</td><td>INJ 3</td></tr>
<tr><td>P3</td><td>INJ 4</td></tr>
<tr><td>P4</td><td>COIL 1</td></tr>
<tr><td>P5</td><td>COIL 2</td></tr>
<tr><td>P6</td><td>COIL 3</td></tr>
<tr><td>P7</td><td>COIL 4</td></tr>
</table>

<h3>PCF8574 #2 (0x21) <span class="badge">AKTIF HIGH</span></h3>
<table>
<tr><th>Pin</th><th>Output</th></tr>
<tr><td>P0</td><td>ISC A</td></tr>
<tr><td>P1</td><td>ISC B</td></tr>
<tr><td>P2</td><td>ISC C</td></tr>
<tr><td>P3</td><td>ISC D</td></tr>
<tr><td>P4</td><td>MIL Lamp</td></tr>
<tr><td>P5</td><td>FUEL Lamp</td></tr>
<tr><td>P6</td><td>FAN Lamp</td></tr>
<tr><td>P7</td><td>Spare</td></tr>
</table>
</div>

<!-- L298 -->
<div class="section">
<h2>5Ô∏è‚É£ L298N Motor Driver</h2>
<table>
<tr><th>L298N</th><th>Koneksi</th><th>Catatan</th></tr>
<tr><td>ENA</td><td class="pin">GPIO32</td><td>PWM speed</td></tr>
<tr><td>IN1</td><td>HIGH</td><td>Hardwired</td></tr>
<tr><td>IN2</td><td>LOW</td><td>Hardwired</td></tr>
<tr><td>OUT1/2</td><td>Motor</td><td>Fixed direction</td></tr>
</table>
</div>

<!-- Notes -->
<div class="section">
<h2>‚ö†Ô∏è Catatan Penting</h2>
<ul>
<li>CKP hanya <b>1 pin (N1+)</b> sesuai UPDATE kode</li>
<li>CKP GEN OUT bisa di-loop ke CKP IN untuk simulasi start</li>
<li>PCF1 aktif LOW ‚Üí pakai transistor / optocoupler</li>
<li>Semua GND harus common</li>
<li>CAN wajib pakai resistor 120Œ© (jika ujung bus)</li>
</ul>
</div>

</body>
                               </html>
