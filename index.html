<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>ECU EMU Wiring Diagram - ESP32</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  margin: 20px;
}
h1, h2, h3 {
  color: #38bdf8;
}
table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: 25px;
}
th, td {
  border: 1px solid #334155;
  padding: 8px;
  text-align: left;
}
th {
  background: #1e293b;
  color: #7dd3fc;
}
.section {
  border: 1px solid #334155;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 30px;
  background: #020617;
}
.pin {
  color: #22c55e;
}
.badge {
  background: #2563eb;
  padding: 2px 6px;
  border-radius: 4px;
  font-size: 12px;
}
.note {
  color: #facc15;
}
</style>
</head>

<body>

<h1>üîß ECU EMU Wiring Diagram</h1>
<p>ESP32 + MCP2515 + 2√ó PCF8574 + 2√ó ADS1115 + L298N</p>

<!-- ================= ESP32 ================= -->
<div class="section">
<h2>1Ô∏è‚É£ ESP32 Core Pins</h2>
<table>
<tr><th>Fungsi</th><th>GPIO ESP32</th><th>Keterangan</th></tr>
<tr><td>CAN CS</td><td class="pin">GPIO 5</td><td>MCP2515 CS</td></tr>
<tr><td>CAN INT</td><td class="pin">GPIO 4</td><td>MCP2515 Interrupt</td></tr>
<tr><td>I2C SDA</td><td class="pin">GPIO 21</td><td>ADS1115 + PCF8574</td></tr>
<tr><td>I2C SCL</td><td class="pin">GPIO 22</td><td>ADS1115 + PCF8574</td></tr>
<tr><td>CKP IN (N1+)</td><td class="pin">GPIO 27</td><td>Input pulsa CKP (REAL)</td></tr>
<tr><td>CKP GEN OUT</td><td class="pin">GPIO 16</td><td>Output CKP 33-3 (loop test)</td></tr>
<tr><td>CMP IN</td><td class="pin">GPIO 34</td><td>Input pulsa CMP</td></tr>
<tr><td>VVT Sense</td><td class="pin">GPIO 25</td><td>ON = VVT terpasang</td></tr>
<tr><td>VVT PWM</td><td class="pin">GPIO 33</td><td>PWM solenoid VVT</td></tr>
<tr><td>REV OUT</td><td class="pin">GPIO 14</td><td>Output RPM ke tachometer</td></tr>
<tr><td>L298 ENA</td><td class="pin">GPIO 32</td><td>PWM motor / ISC</td></tr>
</table>
</div>

<!-- ================= MCP2515 ================= -->
<div class="section">
<h2>2Ô∏è‚É£ MCP2515 CAN BUS</h2>
<table>
<tr><th>MCP2515</th><th>ESP32</th><th>Catatan</th></tr>
<tr><td>CS</td><td class="pin">GPIO 5</td><td>SPI CS</td></tr>
<tr><td>INT</td><td class="pin">GPIO 4</td><td>Interrupt CAN</td></tr>
<tr><td>MOSI</td><td class="pin">GPIO 23</td><td>SPI default</td></tr>
<tr><td>MISO</td><td class="pin">GPIO 19</td><td>SPI default</td></tr>
<tr><td>SCK</td><td class="pin">GPIO 18</td><td>SPI default</td></tr>
<tr><td>CANH</td><td>‚Äî</td><td>Ke OBD / Scanner</td></tr>
<tr><td>CANL</td><td>‚Äî</td><td>Ke OBD / Scanner</td></tr>
</table>
</div>

<!-- ================= ADS1115 ================= -->
<div class="section">
<h2>3Ô∏è‚É£ ADS1115 (ADC)</h2>

<h3>ADS1115 #1 (0x48)</h3>
<table>
<tr><th>Channel</th><th>Sensor</th></tr>
<tr><td>A0</td><td>MAP</td></tr>
<tr><td>A1</td><td>TPS</td></tr>
<tr><td>A2</td><td>ECT / WTS</td></tr>
<tr><td>A3</td><td>IAT</td></tr>
</table>

<h3>ADS1115 #2 (0x49)</h3>
<table>
<tr><th>Channel</th><th>Sensor</th></tr>
<tr><td>A0</td><td>O2 Sensor</td></tr>
<tr><td>A1</td><td>Knock Sensor</td></tr>
<tr><td>A2</td><td>RPM Potensiometer (Simulasi)</td></tr>
<tr><td>A3</td><td>Spare</td></tr>
</table>
</div>

<!-- ================= PCF8574 ================= -->
<div class="section">
<h2>4Ô∏è‚É£ PCF8574 I/O Expanders</h2>

<h3>PCF8574 #1 (0x20) <span class="badge">AKTIF LOW</span></h3>
<table>
<tr><th>Pin</th><th>Fungsi</th></tr>
<tr><td>P0</td><td>INJ 1</td></tr>
<tr><td>P1</td><td>INJ 2</td></tr>
<tr><td>P2</td><td>INJ 3</td></tr>
<tr><td>P3</td><td>INJ 4</td></tr>
<tr><td>P4</td><td>COIL 1</td></tr>
<tr><td>P5</td><td>COIL 2</td></tr>
<tr><td>P6</td><td>COIL 3</td></tr>
<tr><td>P7</td><td>COIL 4</td></tr>
</table>

<h3>PCF8574 #2 (0x21) <span class="badge">AKTIF HIGH</span></h3>
<table>
<tr><th>Pin</th><th>Fungsi</th></tr>
<tr><td>P0</td><td>ISC A</td></tr>
<tr><td>P1</td><td>ISC B</td></tr>
<tr><td>P2</td><td>ISC C</td></tr>
<tr><td>P3</td><td>ISC D</td></tr>
<tr><td>P4</td><td>MIL Lamp</td></tr>
<tr><td>P5</td><td>FUEL Pump Relay</td></tr>
<tr><td>P6</td><td>FAN Relay</td></tr>
<tr><td><b>P7</b></td><td><b>START (STA) ‚Äì Tombol Start</b></td></tr>
</table>

<p class="note">
START (STA): Tombol ‚Üí P7 ‚Üí GND<br>
Logika: LOW = START aktif
</p>
</div>

<!-- ================= L298 ================= -->
<div class="section">
<h2>5Ô∏è‚É£ L298N Motor Driver</h2>
<table>
<tr><th>L298N</th><th>Koneksi</th><th>Catatan</th></tr>
<tr><td>ENA</td><td class="pin">GPIO 32</td><td>PWM speed</td></tr>
<tr><td>IN1</td><td>HIGH</td><td>Arah tetap</td></tr>
<tr><td>IN2</td><td>LOW</td><td>Arah tetap</td></tr>
<tr><td>OUT1 / OUT2</td><td>Motor ISC</td><td>Idle control</td></tr>
</table>
</div>

<!-- ================= NOTES ================= -->
<div class="section">
<h2>‚ö†Ô∏è Catatan Penting</h2>
<ul>
<li>CKP hanya 1 pin (N1+) sesuai update kode</li>
<li>CKP GEN OUT boleh di-loop ke CKP IN untuk simulasi</li>
<li>PCF8574 #1 aktif LOW ‚Üí wajib driver transistor</li>
<li>START aman via PCF karena hanya logika ON/OFF</li>
<li>Semua GND wajib common</li>
<li>CAN bus gunakan resistor 120Œ© di ujung</li>
</ul>
</div>

</body>
</html>
